$('#skillModalBody').html("<%= escape_javascript( render partial: 'modals/addskill' ) %>")
$('#characterSkillModal').modal('show');

skills = $('#characterskill_skill_id').html();
skillListUpdate()
skillListValidation()

$("#characterskill_skill_id").select2({
width: '400',
height: '1000'
});

$('#characterskill_skill_id').change(function() {
  skillListValidation()
});

$('#skillgroup').change(function() {
  skillListUpdate()
  skillListValidation()
});


function skillListValidation() {
  var characterskill = $('#characterskill_skill_id option:selected').text()
  
  if (characterskill == 'Favored Foe') {
    $('#favoredfoe').show()
    document.getElementById("characterskill_favoredfoe").required = true;
  }  else {
    document.getElementById('characterskill_favoredfoe').selectedIndex = -1
    document.getElementById("characterskill_favoredfoe").required = false;
    $('#favoredfoe').hide()
  }
  if (characterskill == 'Alignment Focus') {
    $('#alignmentfocus').show()
    document.getElementById("characterskill_alignmentfocus").required = true;
  }  else {
    document.getElementById('characterskill_alignmentfocus').selectedIndex = -1
    document.getElementById("characterskill_alignmentfocus").required = false;
    $('#alignmentfocus').hide()
  }

}

function skillListUpdate() {
skillgroup = $('#skillgroup :selected').text();
options = $(skills).filter(`optgroup[label='${skillgroup}']`).html();
if (options) {
  $('#characterskill_skill_id').html(options);
} else {
  $('#characterskill_skill_id').empty();
}
}