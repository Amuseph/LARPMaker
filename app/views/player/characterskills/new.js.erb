$('#skillModalBody').html("<%= escape_javascript( render partial: 'player/modals/addskill' ) %>")
$(document).ready(function(){
  $('#characterSkillModal').modal('show');
  skills = $('#characterskill_skill_id').html();
  
  formValidation()
  
  $("#characterskill_skill_id").select2({
  width: '400',
  height: '1000'
  });

  $('#characterskill_skill_id').change(function() {
    formValidation()
  });

  $('#skillgroup').change(function() {
  skillListUpdate()
  });

});

function formValidation() {
  var characterclass = $('#characterskill_skill_id option:selected').text()
  
  if (characterclass == 'Favored Foe') {
    $('#favoredfoe').show()
  }  else {
    document.getElementById('characterskill_favoredfoe').selectedIndex = -1
    $('#favoredfoe').hide()
  }
}

function skillListUpdate() {
skillgroup = $('#skillgroup :selected').text();
options = $(skills).filter(`optgroup[label='${skillgroup}']`).html();
if (options) {
  $('#characterskill_skill_id').html(options);
} else {
  $('#characterskill_skill_id').empty();
}
}